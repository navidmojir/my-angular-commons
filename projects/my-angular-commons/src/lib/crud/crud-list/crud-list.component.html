<div [dir]="params.rtl ? 'rtl' : 'ltr'" class="mat-elevation-z8">
    <div  *ngIf="currentPanel == panelType.LIST">
        <div class="toolbar">
            <button mat-raised-button  *ngIf="operationEnabled(operationType.LIST)"
                (click)="reload()">{{params.labels.refresh}}</button>
            <button mat-raised-button color="primary" *ngIf="operationEnabled(operationType.CREATE)"
                (click)="create()">{{params.labels.create}}</button>

            <ng-container *ngFor="let customAction of params.customGeneralActions">
                <button mat-raised-button  
                    (click)="customAction.onClick()">{{customAction.title}}</button>
            </ng-container>
        </div>

        <mat-divider></mat-divider>
            
        <table mat-table matSort (matSortChange)="applySorting($event)" [dataSource]="entities" >
            <ng-container *ngFor="let fc of params.fieldConfigs">   
                <ng-container matColumnDef="{{fc.name}}">
                    <mat-header-cell *matHeaderCellDef [mat-sort-header]="fc.sortHeader ? fc.name : 'false'" [disabled]="fc.sortHeader ? false : true">{{fc.displayText}}</mat-header-cell>
                    <mat-cell *matCellDef="let element">{{fc.valueTransformer(get(element, fc))}}</mat-cell>
                </ng-container>
            </ng-container>

            <ng-container matColumnDef="operations" stickyEnd>
                <mat-header-cell *matHeaderCellDef>{{params.labels.operations}}</mat-header-cell>
                <mat-cell class="record-operations" *matCellDef="let element">
                    <button mat-raised-button *ngIf="operationEnabled(operationType.DETAILS)"
                        (click)="showDetails(element.id)">{{params.labels.details}}</button>

                    <button mat-raised-button *ngIf="operationEnabled(operationType.UPDATE)" 
                        (click)="edit(element)">{{params.labels.edit}}</button>

                    <button mat-raised-button *ngIf="operationEnabled(operationType.DELETE)" 
                        (click)="delete(element.id)">{{params.labels.delete}}</button>

                    <ng-container *ngFor="let customAction of params.customRecordActions">
                        <button mat-raised-button  
                            (click)="customAction.onClick(element)">{{customAction.title}}</button>
                    </ng-container>
                </mat-cell>
            </ng-container>
            
            <mat-header-row *matHeaderRowDef="displayedCols"></mat-header-row>
            <mat-row *matRowDef="let row; columns: displayedCols;"></mat-row>

            

        </table>

        <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons (page)="applyPaging($event)"></mat-paginator>
    </div>

    <div *ngIf="currentPanel != panelType.LIST">
        <div class="toolbar">
            <button mat-raised-button  
                (click)="changePanel(panelType.LIST)">{{params.labels.backToList}}
            </button>
        </div>

        <mat-divider></mat-divider>

        <app-crud-details *ngIf="currentPanel == panelType.DETAILS" [params]="params" [currentEntityId]="currentEntityId">
        </app-crud-details>

        <app-crud-form *ngIf="currentPanel == panelType.CREATE" [params]="params" [entity]="entity"></app-crud-form>

    </div>
</div>